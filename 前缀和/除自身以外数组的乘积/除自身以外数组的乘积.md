[238. 除自身以外数组的乘积 - 力扣（LeetCode）](https://leetcode.cn/problems/product-of-array-except-self/description/)

```c++
class Solution 
{
public:
    vector<int> productExceptSelf(vector<int>& nums) 
    {
        // //1. 计算出数组的乘积，然后进行除法
        // //时间复杂度：最好O(n) 最坏O(n^2) 空间复杂度O(n)
        // int sum = 1;
        // for (auto x : nums) sum *= x;
        // vector<int> ret;
        // for (int i = 0; i < nums.size(); ++i)
        // {
        //     if (nums[i]) 
        //     {
        //         ret.push_back(sum / nums[i]);
        //     }
        //     else
        //     {
        //         int tmp = 1;
        //         for (int j = 0; j < i; ++j) tmp *= nums[j];
        //         for (int j = i + 1; j < nums.size(); ++j) tmp *= nums[j];
        //         ret.push_back(tmp);
        //     }
        // }
        // return ret;


        // //2. 使用前缀和，计算i位置以外数组的乘积 -- [0, i - 1]乘积*[i + 1, n - 1]乘积
        // //时间复杂度O(n) 空间复杂度O(n)
        // vector<int> left_dp(nums.size());
        // vector<int> right_dp(nums.size());
        // vector<int> ret;
        // //对于left_dp最左侧和right_dp最右侧的值设置为1
        // left_dp[0] = 1, right_dp[nums.size() - 1] = 1;
        // //对左侧前缀和数组进行计算
        // for (int i = 1; i < nums.size(); ++i)
        // {
        //     left_dp[i] = left_dp[i - 1] * nums[i - 1];
        // }
        // //对右侧前缀和数组进行计算
        // for (int i = nums.size() - 2; i >= 0; --i)
        // {
        //     right_dp[i] = right_dp[i + 1] * nums[i + 1];
        // }
        // //对除自身位置的乘积进行计算
        // for (int i = 0; i < nums.size(); ++i)
        // {
        //     ret.push_back(left_dp[i] * right_dp[i]);
        // }
        // //返回结果
        // return ret;


        //3. 对方法2的优化，进行空间优化
        vector<int> ret(nums.size());
        ret[0] = 1;
        //对左侧前缀和ret进行计算
        for (int i = 1; i < nums.size(); ++i)
        {
            ret[i] = ret[i - 1] * nums[i - 1];
        }
        int tmp = 1;
        for(int i = nums.size() - 1; i >= 0; --i)
        {
            ret[i] = ret[i] * tmp;
            tmp *= nums[i]; //计算右侧的乘积
        }
        return ret;
    }
};
```

